%-----------------------------------------------------------------
% 
% onglets
%
\RequirePackage{ifthen,calc,xcolor,graphicx}

\DeclareFixedFont{\ongletfont}{T1}{phv}{b}{n}{24.88pt}

\newcounter{chapitre}
\renewcommand{\thechapitre}{\arabic{chapitre}}

\newlength{\ongletwidth}
\newlength{\ongletheight}
\newlength{\ongletvshift}
\newlength{\ongletvpos}

% facteur de décalage entre les chapitre
\newcommand{\ongletsep}{1.04}

% dimension de la boite qui contient le numéro du  chapitre
\setlength{\ongletheight}{32pt}
\setlength{\ongletwidth}{.96cm}

% position de la première étiquette
\setlength{\ongletvshift}{2cm}

% la couleur de fond de l'onglet
\definecolor{couleurfondonglet}{gray}{.7}

\newcommand{\b@iteonglet}{%
 \colorbox{couleurfondonglet}{%
%   \setlength{\fboxsep}{-1pt}%
%   \setlength{\fboxrule}{1pt}%
%   \fbox{%
    \parbox[t][\ongletheight][s]{\ongletwidth}{%
      \vfill%
      \centering%
      \ifthenelse{\isodd{\value{page}}}{%
        \ongletfont\thechapter}{%
        \reflectbox{\ongletfont\thechapter}}%        
      \vfill}}}

\newcommand{\onglet}{%
  \makebox[0pt][l]{%
    \ifthenelse{\isodd{\value{page}}}{%
      \hspace*{\marginparwidth}%
      \hspace*{\marginparsep}%
      \hspace*{-\ongletwidth}%
      \hspace*{-2\fboxsep}%
    }{%
       \hspace*{-\marginparwidth}%
       \hspace*{-\marginparsep}}%
    \setlength{\ongletvpos}{%
      -\ongletvshift-\ongletheight*\real{\thechapitre}*\real{\ongletsep}}%
    \raisebox{\ongletvpos}[0pt][0pt]{\b@iteonglet}}}


\let\ongletpaire\onglet
\let\ongletimpaire\onglet

\endinput